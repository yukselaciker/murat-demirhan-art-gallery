<!DOCTYPE html>
<html lang="tr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description"
    content="Murat Demirhan - Ã‡aÄŸdaÅŸ ressam. Renklerle hafÄ±zayÄ± yeniden kuran sanat eserleri, sergiler ve portfolyo.">
  <meta name="keywords" content="Murat Demirhan, ressam, sanat, Ã§aÄŸdaÅŸ sanat, yaÄŸlÄ± boya, soyut, figÃ¼ratif, peyzaj">
  <meta name="author" content="Murat Demirhan">

  <!-- Open Graph / Social Media -->
  <meta property="og:title" content="Murat Demirhan - Ã‡aÄŸdaÅŸ Ressam">
  <meta property="og:description"
    content="Renklerle hafÄ±zayÄ± yeniden kuran Ã§aÄŸdaÅŸ ressam. Eserler, sergiler ve iletiÅŸim.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://muratdemirhan.com">
  <meta property="og:image" content="/images/og-image.jpg">

  <title>Murat Demirhan | Ã‡aÄŸdaÅŸ Ressam</title>

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml"
    href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŽ¨</text></svg>">

  <!-- API Preload Hints -->
  <link rel="preconnect" href="https://api.supabase.co" crossorigin>
  <link rel="dns-prefetch" href="https://api.supabase.co">

  <!-- Google Fonts Preconnect -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- ============================================
       CRITICAL: Query Supabase DIRECTLY from client
       Bypasses Vercel cold starts entirely!
       ============================================ -->
  <script>
    // Supabase credentials (injected at build time by Vite)
    (async function () {
      const SUPABASE_URL = '%VITE_SUPABASE_URL%';
      const SUPABASE_KEY = '%VITE_SUPABASE_ANON_KEY%';

      // Check if we have direct Supabase access
      const hasDirectAccess = SUPABASE_URL && !SUPABASE_URL.includes('VITE_') && SUPABASE_KEY && !SUPABASE_KEY.includes('VITE_');

      // Helper: Parse site_settings array to object {cv: {...}, contact: {...}, ...}
      function parseSettings(rows) {
        if (!Array.isArray(rows)) return {};
        const result = {};
        rows.forEach(row => {
          if (row.key && row.value !== undefined) {
            result[row.key] = row.value;
          }
        });
        return result;
      }

      if (hasDirectAccess) {
        // DIRECT SUPABASE QUERY - instant, no cold start!
        console.log('[Prefetch] Querying Supabase directly...');
        const headers = {
          'apikey': SUPABASE_KEY,
          'Authorization': `Bearer ${SUPABASE_KEY}`
        };

        window.__PREFETCH_DATA__ = Promise.all([
          // Artworks - optimized columns
          fetch(`${SUPABASE_URL}/rest/v1/artworks?select=id,title,image_url,year,technique,size,category,created_at&order=created_at.desc&limit=50`, { headers })
            .then(r => r.ok ? r.json() : []).catch(() => []),
          // Exhibitions
          fetch(`${SUPABASE_URL}/rest/v1/exhibitions?select=id,title,year,city,venue,type,description&order=year.desc&limit=30`, { headers })
            .then(r => r.ok ? r.json() : []).catch(() => []),
          // Settings - CORRECT table name: site_settings
          fetch(`${SUPABASE_URL}/rest/v1/site_settings?select=key,value`, { headers })
            .then(r => r.ok ? r.json() : []).then(parseSettings).catch(() => ({}))
        ]).then(([artworks, exhibitions, settings]) => {
          console.log('[Prefetch] Direct query complete:', artworks.length, 'artworks,', Object.keys(settings).length, 'settings');
          return { artworks, exhibitions, settings };
        });
      } else {
        // Fallback to API routes (has cold start delay)
        console.log('[Prefetch] Using API routes...');
        window.__PREFETCH_DATA__ = Promise.all([
          fetch('/api/artworks').then(r => r.ok ? r.json() : []).catch(() => []),
          fetch('/api/exhibitions').then(r => r.ok ? r.json() : []).catch(() => []),
          fetch('/api/settings').then(r => r.ok ? r.json() : {}).catch(() => ({}))
        ]).then(([artworks, exhibitions, settings]) => {
          console.log('[Prefetch] API fetch complete');
          return { artworks, exhibitions, settings };
        });
      }
    })();
  </script>
</head>

<body>
  <!-- React App Container -->
  <div id="root"></div>

  <!-- React Entry Point -->
  <script type="module" src="/src/main.jsx"></script>
</body>

</html>